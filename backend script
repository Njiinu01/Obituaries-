from django.shortcuts import render, redirect
from .models import Obituary
from django.utils.text import slugify

def submit_obituary(request):
    if request.method == 'POST':
        data = request.POST
        slug = slugify(data['name'])
        Obituary.objects.create(
            name=data['name'],
            date_of_birth=data['date_of_birth'],
            date_of_death=data['date_of_death'],
            content=data['content'],
            author=data['author'],
            slug=slug
        )
        return redirect('view_obituaries')
    return render(request, 'obituary_form.html')
